<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monthly Bill Tracker</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- jsPDF library for generating PDF receipts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
        }
        /* Custom scrollbar for bill list */
        #bill-list-container::-webkit-scrollbar {
            width: 8px;
        }
        #bill-list-container::-webkit-scrollbar-thumb {
            background-color: #cbd5e1; /* slate-300 */
            border-radius: 4px;
        }
    </style>
</head>
<body class="min-h-screen p-4 sm:p-8">

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-extrabold text-gray-900 mb-2">Monthly Bill Tracker</h1>
            <p class="text-gray-500">Add your expenses and generate a summary receipt.</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- 1. Add New Bill Form -->
            <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg h-fit">
                <h2 class="text-2xl font-semibold text-gray-800 mb-5 border-b pb-3">Add a New Bill</h2>
                <form id="add-bill-form" class="space-y-4">
                    <div>
                        <label for="bill-name" class="block text-sm font-medium text-gray-700 mb-1">Bill Name</label>
                        <input type="text" id="bill-name" placeholder="e.g., Rent, Electricity, Internet" required
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                    </div>
                    <div>
                        <label for="bill-amount" class="block text-sm font-medium text-gray-700 mb-1">Amount (₱)</label>
                        <input type="number" id="bill-amount" placeholder="e.g., 1200.50" required min="0.01" step="0.01"
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                    </div>
                    <button type="submit"
                            class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-xl hover:bg-blue-700 transition duration-300 shadow-md">
                        Add Bill
                    </button>
                </form>
            </div>

            <!-- 2. Bill List and Total Summary -->
            <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-gray-800 mb-5 border-b pb-3">Monthly Bills Overview</h2>

                <!-- Bill List -->
                <div id="bill-list-container" class="max-h-80 overflow-y-auto mb-6 pr-2">
                    <ul id="bill-list" class="space-y-3">
                        <!-- Bills will be dynamically added here -->
                        <li id="empty-state" class="text-center py-4 text-gray-500 italic">No bills added yet. Start adding your expenses!</li>
                    </ul>
                </div>

                <!-- Total Calculation -->
                <div class="border-t pt-4 flex justify-between items-center">
                    <span class="text-xl font-bold text-gray-900">Total Monthly Obligation:</span>
                    <span id="total-amount" class="text-3xl font-extrabold text-red-600">₱0.00</span>
                </div>

                <!-- PDF Generation Button -->
                <button id="generate-pdf-btn" disabled
                        class="mt-6 w-full py-3 px-4 rounded-xl text-white font-bold transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed bg-green-600 hover:bg-green-700 shadow-md flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                    Generate Receipt (PDF)
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global array to store bill objects
        let bills = [];

        // DOM element references
        const billList = document.getElementById('bill-list');
        const totalAmountSpan = document.getElementById('total-amount');
        const emptyState = document.getElementById('empty-state');
        const generatePdfBtn = document.getElementById('generate-pdf-btn');
        const form = document.getElementById('add-bill-form');
        const billNameInput = document.getElementById('bill-name');
        const billAmountInput = document.getElementById('bill-amount');

        /**
         * Renders the list of bills and calculates the total amount.
         */
        function renderBills() {
            // Clear the existing list
            billList.innerHTML = '';
            let total = 0;

            if (bills.length === 0) {
                emptyState.style.display = 'list-item';
                generatePdfBtn.disabled = true;
                totalAmountSpan.textContent = '₱0.00';
                return;
            }

            emptyState.style.display = 'none';
            generatePdfBtn.disabled = false;

            bills.forEach((bill, index) => {
                total += bill.amount;

                const listItem = document.createElement('li');
                listItem.className = 'flex justify-between items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150';

                // Bill details (Name and Amount)
                const detailSpan = document.createElement('span');
                detailSpan.className = 'text-gray-800 flex-grow truncate';
                detailSpan.innerHTML = `<span class="font-medium">${bill.name}</span> <span class="text-sm text-gray-500 ml-2">(₱${bill.amount.toFixed(2)})</span>`;

                // Delete Button
                const deleteButton = document.createElement('button');
                deleteButton.className = 'ml-4 text-red-500 hover:text-red-700 transition duration-150 p-1 rounded-full hover:bg-red-100';
                deleteButton.innerHTML = `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3m-2 0h10"></path></svg>`;
                deleteButton.onclick = () => removeBill(index);

                listItem.appendChild(detailSpan);
                listItem.appendChild(deleteButton);
                billList.appendChild(listItem);
            });

            // Update total display
            totalAmountSpan.textContent = `₱${total.toFixed(2)}`;
        }

        /**
         * Adds a new bill from the form inputs.
         * @param {Event} e - The form submission event.
         */
        function addBill(e) {
            e.preventDefault();

            const name = billNameInput.value.trim();
            const amount = parseFloat(billAmountInput.value);

            if (name && !isNaN(amount) && amount > 0) {
                bills.push({ name, amount });
                renderBills();

                // Clear form inputs
                form.reset();
                billNameInput.focus();
            } else {
                console.error('Invalid input: Name cannot be empty and amount must be a positive number.');
            }
        }

        /**
         * Removes a bill by its index from the list.
         * @param {number} index - The index of the bill to remove.
         */
        function removeBill(index) {
            bills.splice(index, 1);
            renderBills();
        }

        /**
         * Generates a PDF receipt using jsPDF.
         */
        function generatePDF() {
            if (bills.length === 0) {
                // In a real app, this would use a custom modal/message box, not console error
                console.log("Cannot generate PDF: Please add at least one bill.");
                return;
            }

            // window.jsPDF is provided by the cdn script
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const date = new Date().toLocaleDateString();
            const total = bills.reduce((sum, bill) => sum + bill.amount, 0);

            let yOffset = 20;

            // Title
            doc.setFontSize(22);
            doc.text("Monthly Bill Receipt", 105, yOffset, null, null, "center");
            yOffset += 10;

            // Subtitle / Date
            doc.setFontSize(10);
            doc.setTextColor(150);
            doc.text(`Generated on: ${date}`, 105, yOffset, null, null, "center");
            yOffset += 15;
            doc.setTextColor(0);

            // Table Header
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text("Bill Name", 20, yOffset);
            doc.text("Amount (PHP)", 180, yOffset, null, null, "right");
            yOffset += 5;
            doc.setLineWidth(0.5);
            doc.line(20, yOffset, 190, yOffset); // Separator line
            yOffset += 8;
            doc.setFont(undefined, 'normal');

            // Table Rows (Bills)
            bills.forEach(bill => {
                doc.text(bill.name, 20, yOffset);
                doc.text(`PHP ${bill.amount.toFixed(2)}`, 180, yOffset, null, null, "right");
                yOffset += 7;

                // Check for page overflow
                if (yOffset > 270) {
                    doc.addPage();
                    yOffset = 20;
                    doc.setFontSize(10);
                    doc.text("... continued", 105, yOffset, null, null, "center");
                    yOffset += 10;
                    doc.setFontSize(12);
                }
            });

            // Total Summary
            yOffset += 5;
            doc.setLineWidth(0.5);
            doc.line(140, yOffset, 190, yOffset); // Total separator line
            yOffset += 5;

            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text("TOTAL DUE:", 145, yOffset, null, null, "right");
            doc.text(`PHP ${total.toFixed(2)}`, 180, yOffset, null, null, "right");

            // Save the PDF
            doc.save(`MonthlyBills_${date.replace(/\//g, '-')}.pdf`);
        }

        // --- Event Listeners ---
        form.addEventListener('submit', addBill);
        generatePdfBtn.addEventListener('click', generatePDF);

        // Initial render on load
        window.onload = renderBills;
    </script>
</body>
</html>